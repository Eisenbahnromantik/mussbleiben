<div class="cta">
  <a id="sendLink" class="btn btn-primary">E-Mail öffnen</a>
  <button id="copyBtn" class="btn btn-ghost">Text in Zwischenablage</button>
</div>

<!-- Besucherzähler nur für Button-Klicks -->
<p class="small">E-Mail öffnen geklickt: <span id="mailClicks">–</span></p>

<script>
  const config = {
    to: "kai.gniffke@swr.de",
    subject: "Erhalt der Sendung Eisenbahn-Romantik",
    body: `Sehr geehrter Herr Prof. Dr. Gniffke,\n\n...`
  };

  // Mailto-Link zusammenbauen
  const mailto = `mailto:${config.to}?subject=${encodeURIComponent(config.subject)}&body=${encodeURIComponent(config.body)}`;
  const sendLink = document.getElementById('sendLink');
  sendLink.setAttribute('href', mailto);

  // Klicks zählen mit countapi
  function updateMailClicks(data){
    document.getElementById('mailClicks').textContent = data?.value ?? '0';
  }

  // Startwert laden
  (function(){
    const s = document.createElement('script');
    s.src = 'https://api.countapi.xyz/get/eisenbahnromantik/mussbleiben_mailto?callback=updateMailClicks';
    document.body.appendChild(s);
  })();

  // Bei Klick hochzählen
  sendLink.addEventListener('click', () => {
    try {
      fetch('https://api.countapi.xyz/hit/eisenbahnromantik/mussbleiben_mailto', {mode: 'no-cors', keepalive: true});
    } catch(_) {}
  });

  // Text in Zwischenablage (bleibt wie gehabt)
  const copyBtn = document.getElementById('copyBtn');
  copyBtn.addEventListener('click', async () => {
    try {
      await navigator.clipboard.writeText(config.body);
      copyBtn.textContent = 'Text kopiert ✔';
      setTimeout(()=> copyBtn.textContent = 'Text in Zwischenablage', 1600);
    } catch(e){
      alert('Kopieren nicht erlaubt – bitte manuell markieren und kopieren.');
    }
  });
</script>
